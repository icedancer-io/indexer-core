# Research

- Important: in good indexing, simply look at the event to reconstruct off-chain state. We don't have cost restrictions when emitting more fields unlike in Solana.

- Find the log block for your program. Log block begins with `Program 675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8 invoke [1]` and ends with `Program 675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8 success`

- Look for `Program log:` blocks that immediately follow the `invoke [1]` section. If another invoke section is encountered, the log belongs to the other program, not the current one. These inner call blocks end with `Program XYZ success`, so we also look for logs that come after this part.

- Try to deserialize the log based on the event decoder generated by Anchor.

- If the event is deserialized execute the callback function. The callback function does some processing and stores the result in subgraph entities.

```
"Program 675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8 invoke [1]",
"Program log: ray_log: AxTRd157WwcA66ZtWgAAAAACAAAAAAAAABTRd157WwcApheQGJxEAQFnwgsSDwAAAEMOAWsAAAAA",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA invoke [2]",
"Program log: Instruction: Transfer",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA consumed 4645 of 961750 compute units",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA success",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA invoke [2]",
"Program log: Instruction: Transfer",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA consumed 4736 of 954124 compute units",
"Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA success",
"Program 675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8 consumed 32249 of 980835 compute units",
"Program 675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8 success",
```

## Unnecessary method

- Indexing is namespaced by program address. Traverse through each slot. If the required program address is present
  - Find the index of the program
  - Find instructions and inner instructions with the given `programIdIndex`. This can be used to find input value and accounts passed to the program. Unnecessary, use events only.
  -